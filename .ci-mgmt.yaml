provider: awsx
aws: true
major-version: 2
template: generic
shards: 10
freeDiskSpaceBeforeTest: true # TODO: https://github.com/pulumi/pulumi/issues/17718
env:
  ALT_AWS_ACCESS_KEY_ID: ${{ secrets.ALT_AWS_ACCESS_KEY_ID }}
  ALT_AWS_SECRET_ACCESS_KEY: ${{ secrets.ALT_AWS_SECRET_ACCESS_KEY }}
  AWS_REGION: us-west-2
  GITHUB_TOKEN: ${{ secrets.PULUMI_BOT_TOKEN }}
  GOLANGCI_LINT_VERSION: v1.61.0
  NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
  NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
  PROVIDER: eks
  PUBLISH_REPO_PASSWORD: ${{ secrets.OSSRH_PASSWORD }}
  PUBLISH_REPO_USERNAME: ${{ secrets.OSSRH_USERNAME }}
  PULUMI_ACCESS_TOKEN: ${{ secrets.PULUMI_ACCESS_TOKEN }}
  PULUMI_API: https://api.pulumi-staging.io
  PULUMI_GO_DEP_ROOT: ${{ github.workspace }}/..
  SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
  SIGNING_KEY: ${{ secrets.JAVA_SIGNING_KEY }}
  SIGNING_KEY_ID: ${{ secrets.JAVA_SIGNING_KEY_ID }}
  SIGNING_PASSWORD: ${{ secrets.JAVA_SIGNING_PASSWORD }}
  PULUMI_ENABLE_RESOURCE_REFERENCES: 1
  PULUMI_LOCAL_NUGET: ${{ github.workspace }}/nuget

# lint: false
# parallel: 1
# timeout: 150
# generate-nightly-test-workflow: true
# providerVersion: github.com/hashicorp/terraform-provider-aws/version.ProviderVersion
# toolVersions:
#   dotnet: "6.0.x"
#   go: "1.23.x"
#   java: "11"
#   gradle: "7.6"
#   nodejs: "20.x"
#   pulumi: "dev"
#   python: "3.11.8"
# env:
#   PULUMI_MISSING_DOCS_ERROR: true
#   AWS_REGION: "us-west-2"
#   OIDC_ROLE_ARN: ${{ secrets.OIDC_ROLE_ARN }}
# makeTemplate: bridged
# checkoutSubmodules: true
# freeDiskSpaceBeforeBuild: true
# freeDiskSpaceBeforeSdkBuild: true
# freeDiskSpaceBeforeTest: true
# # TODO: remove XrunUpstreamTools flag after work to add docs replacement strategies to resources.go is completed
# # Tracked in in https://github.com/pulumi/pulumi-aws/issues/2757
# XrunUpstreamTools: true
# plugins:
#   - name: archive
#     version: "0.0.1"
#   - name: tls
#     version: "4.10.0"
#   - name: github
#     version: "4.10.0"
#   - name: kubernetes
#     version: "4.11.0"
#   - name: "null"
#     version: "0.0.3"
#   - name: "local"
#     version: "0.1.0"
#   - name: random
#     version: "4.8.2"
#   - name: github
#     version: "5.14.0"
#   - name: std
#     version: "1.6.2"
#   - name: terraform
#     version: "1.0.17"
#     kind: converter
# # Use `pulumi convert` for translating examples from TF to Pulumi.
# pulumiConvert: 1
# goBuildParallelism: 2
# actions:
#   preTest:
#     - name: Configure AWS Credentials
#       uses: aws-actions/configure-aws-credentials@v4
#       with:
#         aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
#         aws-region: ${{ env.AWS_REGION }}
#         aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
#         role-duration-seconds: 7200
#         role-session-name: aws@githubActions
#         role-to-assume: ${{ secrets.AWS_CI_ROLE_ARN }}
